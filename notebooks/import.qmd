---
title: "Agriculture processing"
format:
  html:
    code-fold: true
jupyter: python3
---

```{python}
import os
os.chdir("..")
from dotenv import load_dotenv
load_dotenv()
```

```{python}
import polars as pl
import ibis
import plotly.graph_objects as go
import requests
from src.jp_imports.data_process import DataProcess
from src.dao.jp_imports_raw import *
from src.jp_imports.data_pull import DataPull
d = DataProcess("postgresql://postgres:password@localhost:5433/timescaledb","data/")
pull = DataPull(os.environ.get("DATABASE_URL"))
```

```{python}
d.process_jp_base()
```


```{python}
pull.pull_int_jp()
```

```{python}
pl.DataFrame(select_all_jp_trade_data(pull.engine))
```
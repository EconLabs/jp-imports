---
title: "Moving price graph"
format:
  html:
    code-fold: true
jupyter: python3
---

```{python}
import os
os.chdir("..")
```

```{python}
from src.jp_imports.data_process import DataTrade
from src.jp_imports.data_pull import DataPull
from polars.testing import assert_frame_equal
import polars as pl
import ibis

ibis.options.interactive = True

d = DataPull("sqlite:///test.sqlite",debug=True, dev=True)
conn = ibis.sqlite.connect("test.sqlite")
```

```{python}
d.insert_int_jp("test/test_inserts/jp_data_sample.csv", "data/external/code_agr.json")
d.insert_int_org("test/test_inserts/org_data_sample.parquet")
```

```{python}
conn.table("inttradedata").to_parquet("test/test_inserts/test_org_data.parquet")
```

```{python}
df1 = conn.table("inttradedata").to_polars()
df2 = pl.read_parquet("test/test_inserts/test_org_data.parquet")
assert_frame_equal(df1, df2, check_dtypes=False)
```